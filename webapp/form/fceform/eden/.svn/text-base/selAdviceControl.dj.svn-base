<script>function addItemCommon(){&#13;&#10;	var grid=getGrid('grid1');&#13;&#10;	var checkedID=grid.getCheckedRows(0);&#13;&#10;	var ds=getDs('ds1');&#13;&#10;	var sel=$('#adviceSel');&#13;&#10;	if(checkedID.length>0){&#13;&#10;		checkedID=checkedID.split(',');&#13;&#10;		for (var i = 0; i < checkedID.length; i++) {&#13;&#10;			var id = checkedID[i];&#13;&#10;			var thisItem=ds.item(id);&#13;&#10;			$('#user_'+thisItem.dict_value).remove();&#13;&#10;			sel.append('<option id="user_'+thisItem.dict_value+'" value="'+thisItem.dict_value+'">'+thisItem.display_name+'</option>');&#13;&#10;&#13;&#10;		}&#13;&#10;	}else{&#13;&#10;		$.dialog.tips('请至少选上一个!',2);&#13;&#10;	}&#13;&#10;&#13;&#10;}&#13;&#10;function delItemCommon(){&#13;&#10;	$("#adviceSel option:selected").remove();&#13;&#10;}&#13;&#10;&#13;&#10;function btn_ok(){&#13;&#10;	var userId=[];&#13;&#10;	var userName=[];&#13;&#10;	$("#adviceSel option").each(function(){&#13;&#10;		userId.push($(this).val());&#13;&#10;		userName.push($(this).text());&#13;&#10;	});&#13;&#10;	 var stepId = QueryURL.GetValue('step_id'); &#13;&#10;	 var actionId = QueryURL.GetValue('action_id'); &#13;&#10;     var wfName = QueryURL.GetValue('wf_name'); &#13;&#10;	 var controlType=1;&#13;&#10;	 var controlValues=userId+"";&#13;&#10;	  $.post(project+"/admin/documentConfig/doInsertDocumentWfControl.action", {"stepId":stepId,"actionId":actionId,"wfName":wfName,"controlType":controlType,"controlValues":controlValues},function(result){&#13;&#10;			 if(result&&result.result=="success")&#13;&#10;			{&#13;&#10;			  alert(result.message)	&#13;&#10;			}else{&#13;&#10;			 alert("保存失败，请确保是登录状态！")	&#13;&#10;			}&#13;&#10;		   &#13;&#10;               window.close();  &#13;&#10;		});&#13;&#10;	//window.parent.edenWins.window('commonSelUser').close();&#13;&#10;}&#13;&#10;&#13;&#10;function load()&#13;&#10;{&#13;&#10;   var sel=$('#adviceSel');&#13;&#10;   var ds=getDs('datasetHas');&#13;&#10;   var count = ds.dataCount();&#13;&#10;   	for (var i = 0; i < count; i++) {&#13;&#10;		var id = ds.idByIndex(i);&#13;&#10;		var dataItem=ds.item(id);&#13;&#10;		var value=dataItem.value;&#13;&#10;		var name=dataItem.name;&#13;&#10;		sel.append('<option id="user_'+value+'" value="'+value+'">'+name+'</option>');&#13;&#10;&#13;&#10;	}&#13;&#10; &#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib isCheckPermit="否" alertType="1" contxml="<root><label><id>label3</id></label><listbox><id>adviceSel</id></listbox><button><id>button3</id><id>button4</id><id>button5</id></button><grid><id>grid1</id></grid><dataset><id>ds1</id><id>datasetHas</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:3;radio:0;listbox:1;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:5;text:1;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:0;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;editor:0" billtaborder="<root><taborder>grid1</taborder><taborder>adviceSel</taborder><taborder>button3</taborder><taborder>button4</taborder><taborder>button5</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="公用选择用户" type="eden_form" dj_sn="selAdviceControl" toolbar="不带工具栏" unselectable="on" BLONopen="load()" center="  " BLONclose BLONopenBefore userType><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 32px; HEIGHT: 32px; TOP: 273px; LEFT: 717px" id=ds1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" isInAddStatus="是" async="否" isSubGrid="否" saveastable AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql="select display_name,dict_value from ea_data_dictionary a&#13;&#10;where dict_group_id = 'oa_send_document_advice_type'&#13;&#10;" pubpara="否" formatxml='<root><tr rowstate="add"><td>display_name</td><td>名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>dict_value</td><td>值</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' isaddemptyrec="否" submittype="4" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield opensortno="1" idtype="1" controltype="dataset" datasourceName> 
<DIV onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 239px; HEIGHT: 267px; TOP: 42px; LEFT: 23px" id=grid1 class=ef_design_grid onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="grid" crosstabdatatype="0" crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabtitle iscrosstab="否" bodyrows="20" bodyrowheight="-1" usertitle usertitlehtml titlerows titlerowheight readonly="否" visible="是" dataset="ds1" isPage="是" colWidth="100,*" colType="ro,ro" colSort="str,str" showCheckbox="是" src="../images/ef_designer_webgrid.gif"></DIV><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BACKGROUND-IMAGE: none; POSITION: absolute; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 75px; PADDING-RIGHT: 0px; BACKGROUND-REPEAT: no-repeat; BACKGROUND-POSITION: 0px 0px; HEIGHT: 25px; TOP: 329px; PADDING-TOP: 0px; LEFT: 273px" id=button3 onresize=resize() onmove=move() class=ef_button onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("btn_ok()")'>保存</BUTTON><SELECT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 140px; HEIGHT: 259px; TOP: 51px; LEFT: 370px" id=adviceSel onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() multiple size=8 async="否" controltype="listbox" datasourceName sql check="1" tempvalue temptext></SELECT><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 106px; LEFT: 284px" id=button4 onresize=resize() onmove=move() class=ef_button onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("addItemCommon()")' CustomAttr="title=添加人员">&gt;&gt;</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 153px; LEFT: 285px" id=button5 onresize=resize() onmove=move() class=ef_button onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("delItemCommon()")' CustomAttr="title=删除人员">&lt;&lt;</BUTTON><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 128px; FONT-FAMILY: 宋体; HEIGHT: 22px; TOP: 27px; FONT-WEIGHT: bold; LEFT: 372px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">已添加的意见：</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 32px; HEIGHT: 32px; TOP: 353px; LEFT: 681px" id=datasetHas onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" isInAddStatus="是" async="否" isSubGrid="否" saveastable AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql="select a.control_value value , ea.display_name name&#13;&#10; from oa_document_wf_control a &#13;&#10;inner join  ea_data_dictionary ea&#13;&#10;on a.control_value = ea.dict_value&#13;&#10;where dict_group_id = 'oa_send_document_advice_type' and wf_name=':{$urlParam(&quot;wf_name&quot;)}:' and step_id =':{$urlParam(&quot;step_id&quot;)}:' and control_type=1 &#13;&#10;" pubpara="否" formatxml='<root><tr rowstate="add"><td>value</td><td>value</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>name</td><td>name</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' isaddemptyrec="否" submittype="4" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield opensortno="1" idtype="1" controltype="dataset" datasourceName></DIV><p id=splitaddhtml /><style>

</style>
