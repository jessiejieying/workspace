<script>var wfId = QueryURL.GetValue('wf_id');&#13;&#10;var WfName = "";&#13;&#10;var WfDesc = "";&#13;&#10;var WfVersion = "";&#13;&#10;function afterLoad() {&#13;&#10;	var sKey = "?operate=get_flow_info&wf_id=" + wfId;&#13;&#10;	$.ajax({&#13;&#10;		type       :"POST",&#13;&#10;		url        :project + "/servlet/WorkflowPortal" + sKey,&#13;&#10;		processData:false,&#13;&#10;		data       :'<root></root>',&#13;&#10;		contentType:'utf-8',&#13;&#10;		success    :function (msg) {&#13;&#10;			var oDom = newXml(msg);&#13;&#10;			var bResult = $(oDom).find('n').eq(0).text();&#13;&#10;			if (bResult == "false") {&#13;&#10;				$.dialog.alert("获取流程信息发生错误：" + $(oDom).find('message').text(), 5);&#13;&#10;				return;&#13;&#10;			} else {&#13;&#10;				var wfInfo = $(oDom).find('n').eq(1);&#13;&#10;				WfName = wfInfo.find('wf_name').text();&#13;&#10;				WfDesc = wfInfo.find('wf_desc').text();&#13;&#10;				WfVersion = wfInfo.find('wf_version').text();&#13;&#10;				LoadWorkflowTrace(wfId, 'flow', 'ds1');&#13;&#10;			}&#13;&#10;&#13;&#10;		},&#13;&#10;		error      :function (msg) {&#13;&#10;			$.dialog.tips('访问后台失败！')&#13;&#10;		}&#13;&#10;	});&#13;&#10;	var grid = getGrid('grid1');&#13;&#10;	var dataStore = getDs('ds1');&#13;&#10;	grid.attachEvent("onRowDblClicked", function (rId, cInd) {&#13;&#10;		var item = dataStore.item(rId);&#13;&#10;		openHistoryAction(item.stepid, item.actionid, item.dynamic_instance_id, item.traceId, item.stepType);&#13;&#10;	});&#13;&#10;&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="raphael.js" isCheckPermit="否" alertType="1" BLONopenBefore userType BLONclose center="  " contxml="<root><label><id>label1</id><id>label2</id></label><img><id>img1</id><id>img2</id></img><tab><id>tab1</id></tab><div><id>div3</id><id>flow</id></div><grid><id>grid1</id></grid><dataset><id>ds1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:1;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:2;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;editor:0" billtaborder="<root><taborder>grid1</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="流程图" type="eden_wf" dj_sn="wf_history_list" toolbar="不带工具栏" unselectable="on" BLONopen="afterLoad()"><DIV style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; BACKGROUND-COLOR: #ffffff; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 940px; PADDING-RIGHT: 0px; HEIGHT: 50px; BORDER-TOP: 0px; TOP: 709px; BORDER-RIGHT: 0px; PADDING-TOP: 0px; LEFT: 5px" id=div3 onmovestart=moveStart() controltype="div" NotBg="否"></DIV><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 448px; LEFT: 1028px" id=ds1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" iscreatetable idtype="1" formatxml="<root><tr rowstate=&quot;add&quot;><td>stepType</td><td>步骤类型</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>step</td><td>步骤名称</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>110</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>stepid</td><td>步骤id</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>50</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>action</td><td>执行的动作</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>110</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>actionid</td><td>动作id</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>50</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>dynamic_instance_id</td><td>分支实例id</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>40</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>status</td><td>步骤状态</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>70</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>caller</td><td>执行者</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>90</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>remark</td><td>执行备注</td><td>字符</td><td>200</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>160</td><td></td><td></td><td></td><td></td><td></td><td>openHistoryAction(ds1.Field('stepid').Value,ds1.Field('actionid').Value,ds1.Field('dynamic_instance_id').Value,ds1.Field('traceId').Value,ds1.Field('stepType').Value,ds1.Field('subwfId').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>startDate</td><td>开始时间</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>110</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>finishDate</td><td>完成时间</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>110</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>previous</td><td>上一步骤</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>traceId</td><td>步骤轨迹id</td><td>整数</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>subwfId</td><td>子流程实例id</td><td>整数</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" AfterScroll BeforeScroll AfterPost BeforePost AfterOpen masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" BeforeOpen opensql isSubGrid="否" isaddemptyrec="否" pubpara="否" saveastable opensortno="2" async="否" datasourceName>&nbsp;&nbsp; 
<DIV onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 930px; HEIGHT: 760px; TOP: 10px; LEFT: 10px" id=tab1 onresize=page_onresize() class=tab-pane3 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="tab" value="流程图">
<TABLE id=fcpagesubtable class=dynamic-tab-pane-control onmousedown=pageonclick() onresizestart=CancelEvent()>
<TBODY>
<TR class=tab-row contentEditable=false>
<TD class="tab selected"><FONT size=2>流程图</FONT></TD>
<TD class=tab><FONT size=2>流程记录</FONT></TD></TR></TBODY></TABLE>
<DIV oncontrolselect=controlselect() style="Z-INDEX: 1; POSITION: absolute; WIDTH: 928px; HEIGHT: 740px; TOP: 25px" id=fcpagesub class=tab-page onmovestart=CancelEvent() onresizestart=CancelEvent()>
<DIV style="BORDER-BOTTOM: #cecece 1px solid; POSITION: absolute; BORDER-LEFT: #cecece 1px solid; PADDING-BOTTOM: 0px; OVERFLOW-X: auto; OVERFLOW-Y: auto; BACKGROUND-COLOR: #ffffff; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 900px; PADDING-RIGHT: 0px; HEIGHT: 645px; BORDER-TOP: #cecece 1px solid; TOP: 14px; BORDER-RIGHT: #cecece 1px solid; PADDING-TOP: 0px; LEFT: 13px" id=flow onmovestart=moveStart() controltype="div" NotBg="否"><IMG style="POSITION: absolute; TOP: 5px; LEFT: 12px" id=img1 onmovestart=moveStart() src="../../resources/common/images/wf_little_ok.gif" controltype="img" cover="9" srcsk="../../resources/common/images/wf_little_ok.gif"><LABEL style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 113px; FONT-FAMILY: 宋体; HEIGHT: 19px; COLOR: #808080; FONT-SIZE: 9pt; TOP: 7px; FONT-WEIGHT: bold; LEFT: 31px" id=label1 onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">已经完成的节点</LABEL><LABEL style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 110px; FONT-FAMILY: 宋体; HEIGHT: 19px; COLOR: #808080; FONT-SIZE: 9pt; TOP: 27px; FONT-WEIGHT: bold; LEFT: 31px" id=label2 onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">正在运行的节点</LABEL><IMG style="POSITION: absolute; TOP: 25px; LEFT: 11px" id=img2 onmovestart=moveStart() src="../../resources/common/images/wf_little_run.gif" controltype="img" cover="9" srcsk="../../resources/common/images/wf_little_run.gif"></DIV></DIV>
<DIV oncontrolselect=controlselect() style="Z-INDEX: 0; POSITION: absolute; WIDTH: 928px; HEIGHT: 740px; TOP: 25px" id=fcpagesub class=tab-page onmovestart=CancelEvent() onresizestart=CancelEvent()>
<DIV onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 900px; HEIGHT: 554px; TOP: 13px; LEFT: 9px" id=grid1 class=ef_design_grid onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="grid" bodyrows="-1" bodyrowheight="-1" readonly="否" titlerowheight usertitle titlerows usertitlehtml iscrosstab="否" crosstabtitle crosstabdatatype="0" crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql showCheckbox="否" colSort colType colWidth="100,*,100,100,100,180,180" isPage="否" visible="是" dataset="ds1" src="../images/ef_designer_webgrid.gif"></DIV></DIV></DIV></DIV>