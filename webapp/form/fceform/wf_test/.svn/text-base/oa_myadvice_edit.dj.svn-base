<script>&#13;&#10;var gridOb;&#13;&#10;var gridRowMaxIndex;&#13;&#10;&#13;&#10;function sub()&#13;&#10;{&#13;&#10;  var addAdvices="";&#13;&#10;   var pRowIdArr = gridOb.getAllRowIds(',').split(',');&#13;&#10;  &#13;&#10;    for(i=0;i<pRowIdArr.length;i++){ &#13;&#10;	  var con= gridOb.cellById(pRowIdArr[i],0).getValue();&#13;&#10;          addAdvices+=";"+con;&#13;&#10;    }&#13;&#10;    if(!addAdvices)&#13;&#10;    {&#13;&#10;        $.dialog.tips("请添加意见!");&#13;&#10;        return;&#13;&#10;    }&#13;&#10;    addAdvices=addAdvices.substring(1);&#13;&#10;   &#13;&#10;$('#text9').val(addAdvices);&#13;&#10;   &#13;&#10;   var op="保存";&#13;&#10;&#13;&#10;   doSubmitData(function () {&#13;&#10;	$.dialog.tips(op+"成功!");&#13;&#10;      &#13;&#10;     try{&#13;&#10;		window.edenCallBack(addAdvices);&#13;&#10;&#13;&#10;	}catch (e){&#13;&#10;&#13;&#10;     }&#13;&#10;  &#13;&#10;    &#13;&#10;&#13;&#10;   });&#13;&#10;&#13;&#10;  &#13;&#10;&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function load()&#13;&#10;{&#13;&#10;    &#13;&#10;   gridOb =getGrid('grid1');&#13;&#10;  &#13;&#10;   var listStr=$('#text9').val();&#13;&#10;     &#13;&#10;     &#13;&#10;   var listArr=listStr.split(';');&#13;&#10;   for(var i=0;i<listArr.length;i++)&#13;&#10;    {&#13;&#10;       var ad=listArr[i];&#13;&#10;        if(ad)&#13;&#10;        {&#13;&#10;          gridOb.addRow(i,[ad],i);  &#13;&#10;        }&#13;&#10;        &#13;&#10;&#13;&#10;    }&#13;&#10; gridRowMaxIndex=listArr.length;&#13;&#10;  &#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function addRow()&#13;&#10;{&#13;&#10;   var addCon=$('#text8').val();&#13;&#10;&#13;&#10;   if(addCon)&#13;&#10;   {&#13;&#10;     &#13;&#10;     //var date=new Date().getTime();&#13;&#10;     gridRowMaxIndex++;&#13;&#10;     gridOb.addRow(gridRowMaxIndex,[addCon],gridRowMaxIndex);  &#13;&#10;      $('#text8').val('');&#13;&#10;&#13;&#10;   }else{&#13;&#10;       $.dialog.tips("添加内容不能为空！   ");&#13;&#10;     &#13;&#10;   }&#13;&#10;   &#13;&#10;    &#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function delRow()&#13;&#10;{&#13;&#10;   var row_id = gridOb.getSelectedRowId();&#13;&#10;	if (row_id === '') {&#13;&#10;           $.dialog.tips('请选择一条意见！');&#13;&#10;            return;&#13;&#10;        }&#13;&#10;	gridOb.deleteRow(row_id);&#13;&#10;	&#13;&#10;&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib isCheckPermit="否" alertType="1" contxml="<root><button><id>button1</id><id>button5</id><id>button6</id></button><text><id>text8</id><id>text9</id></text><grid><id>grid1</id></grid><dataset><id>dataset1</id><id>dataset2</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:8;radio:2;listbox:1;textarea:2;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:6;text:9;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:1;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;editor:0" billtaborder="<root><taborder>button1</taborder><taborder>grid1</taborder><taborder>button5</taborder><taborder>text8</taborder><taborder>text9</taborder><taborder>button6</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="意见添加" type="eden_wf" dj_sn="oa_myadvice_edit" toolbar="不带工具栏" unselectable="on" BLONopen="load()" center="  " BLONclose BLONopenBefore userType><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BACKGROUND-IMAGE: url(none); POSITION: absolute; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 75px; PADDING-RIGHT: 0px; BACKGROUND-REPEAT: no-repeat; BACKGROUND-POSITION: 0px 0px; HEIGHT: 25px; PADDING-TOP: 0px; TOP: 257px; LEFT: 119px" id=button1 onmovestart=moveStart() onresize=resize() onmove=move() class=ef_button onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("sub()")'>保存</BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 32px; HEIGHT: 32px; TOP: 211px; LEFT: 477px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" async="否" isSubGrid="否" saveastable AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql="select * from  oa_document_myselectadvice  where username=':{$urlParam(&quot;username&quot;)}:'" pubpara="否" formatxml="<root><tr rowstate=&quot;add&quot;><td>username</td><td>用户名</td><td>字符</td><td>512</td><td>0</td><td>数据项</td><td>GetSessionOne('userid')</td><td></td><td>否</td><td>否</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>content</td><td>意见内容</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>id</td><td>id</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" isaddemptyrec="否" submittype="1" submitno="1" savetable="oa_document_myselectadvice" idparam="BBB" issubds="否" subdsfield masterds masterdsfield opensortno="1" idtype="1" isInAddStatus="是" datasourceName>&nbsp;&nbsp; 
<DIV onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 247px; HEIGHT: 198px; TOP: 45px; LEFT: 41px" id=grid1 onmovestart=moveStart() class=ef_design_grid onmoveend=moveEnd() onresizestart=resizeStart() dataset="dataset2" controltype="grid" visible="是" src="../images/ef_designer_webgrid.gif" titlerowheight titlerows usertitlehtml usertitle readonly="否" isPage="否" bodyrowheight="-1" colWidth="200" colType="co" colSort="str" showCheckbox="否" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"></DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 106px; HEIGHT: 20px; TOP: 11px; LEFT: 40px" id=text8 onmovestart=moveStart() onresize=resize() onmove=move() onmoveend=moveEnd() onresizestart=resizeStart() size=19 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BACKGROUND-IMAGE: url(none); POSITION: absolute; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 58px; PADDING-RIGHT: 0px; BACKGROUND-REPEAT: no-repeat; BACKGROUND-POSITION: 0px 0px; HEIGHT: 22px; PADDING-TOP: 0px; TOP: 11px; LEFT: 163px" id=button5 onmovestart=moveStart() onresize=resize() onmove=move() class=ef_button onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("addRow()")'>添加</BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 32px; HEIGHT: 32px; TOP: 110px; LEFT: 527px" id=dataset2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" async="否" isSubGrid="否" saveastable AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql pubpara="否" formatxml='<root><tr rowstate="add"><td>content</td><td>意见</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' isaddemptyrec="否" submittype="4" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield opensortno="1" idtype="1" isInAddStatus="是" datasourceName><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 110px; DISPLAY: none; HEIGHT: 20px; TOP: 305px; LEFT: 101px" id=text9 onmovestart=moveStart() onresize=resize() onmove=move() onmoveend=moveEnd() onresizestart=resizeStart() value=意见内容 dataset="dataset1" china="意见内容" field="content" controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BACKGROUND-IMAGE: url(none); POSITION: absolute; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 59px; PADDING-RIGHT: 0px; BACKGROUND-REPEAT: no-repeat; BACKGROUND-POSITION: 0px 0px; HEIGHT: 24px; PADDING-TOP: 0px; TOP: 11px; LEFT: 231px" id=button6 onmovestart=moveStart() onresize=resize() onmove=move() class=ef_button onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("delRow()")'>删除</BUTTON></DIV>